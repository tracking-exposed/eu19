{{ define "main" -}}

<header class="entry-header search-page">
    <figure class="left">
        <img src="/images/country/{{ urlize .Title }}.svg" />
    </figure>
    <div class="page-info left">
        <h1 class="top">{{ .Title }}</h1>
        <small><a href="/country">Change country</a></small>
        <ul class="preview-data">
            <li class="language-icon icon-small">
                 <b class="language-data">{{ .Params.lang }}</b> language
                <small><a href="/language">Change language</a></small>
            </li>
            <li class="contributors-icon icon-small">
                <b class="contributors-data"></b> contributors<br />
                <small>Means that we collect data from <b class="contributors-data"></b> people who has download our extension. <a href='{{ ref . "/page/get-the-extension.md" }}' title="Download the browser extension">Be one of them</a>.</small>
            </li>
        </ul>
    </div>
    <span class="clear"></span>
</header>

<div class="search-page-container" id="search-page">
    <div class="column_1-3">
        <h3 class="top">
            Most used keywords<br />
            <small class="paragraph">In the last 7 days</small>
        </h3>
        <div id="most-used-keywords"></div>
    </div>
    <div class="column_2-3 omega">

        <b class="keyword"></b>

    </div>
    <span class="clear"></span>
</div>


<script type="text/javascript">
    window.onload = function() {
        jQuery(document).ready(function($) {
            /**
             *  most used keywords data
             */
            var mostUsedKeys;
            $.getJSON("https://gist.githubusercontent.com/vecna/b3aed1224d8873e58f80f1c4705ce94c/raw/cb4bea12b4de951ccd2403cc8b74608e864ba1fa/topk-IT.json", function (data) {
                var items = [];
                $.each(data, function (key, val) {
                    items.push("<li id='" + key + "' class='keyword-element' data-value='" + val['label'] + "'><a href='/country/{{ urlize .Title }}/#" + val['label'] + "'>" + val['label'] + "</a> " + "(" + val['count'] + ")</li>");
                });
                $("<ul/>", {
                    html: items.join("")
                }).appendTo("#most-used-keywords");
            });

            $(document).on('click',".keyword-element",function (e) {
                var ref = $(this).attr('data-value');
                e.preventDefault();
                removeLocationHash();
                window.location.href += '#'+ref;
                location.reload();

            });

            function removeLocationHash(){
                var noHashURL = window.location.href.replace(/#.*$/, '');
                window.history.replaceState('', document.title, noHashURL)
            }
        });
    };

</script>

{{- end }}